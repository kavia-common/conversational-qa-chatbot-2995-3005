{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints for messaging functionality in a FastAPI web application, including sending messages within a session and listing messages for a session. It involves interaction with session storage and a question-answering service.", "external_files": ["src/services/session_store", "src/services/qa_service"], "external_methods": ["SessionStore.get_instance", "SessionStore.get_session", "SessionStore.add_message", "SessionStore.get_messages", "SessionStore.get_message_count", "QAService.get_instance", "qa_service.answer"], "published": ["router"], "classes": [{"name": "ChatMessage", "description": "Model representing a chat message with role, content, and timestamp."}, {"name": "SendMessageRequest", "description": "Model for the request payload to send a message, including session ID and message content."}, {"name": "SendMessageResponse", "description": "Model for the response after sending a message, including session ID, user and assistant messages, and total message count."}, {"name": "ListMessagesResponse", "description": "Model for listing messages in a session, including session ID and the list of messages."}], "methods": [{"name": "send_message(payload: SendMessageRequest)", "description": "Endpoint to handle sending a user message, storing it, generating an assistant reply, and returning the conversation state.", "scope": "", "scopeKind": ""}, {"name": "list_messages( session_id: str = Query(..., description=\"Session ID to fetch messages for\"), )", "description": "Endpoint to list all messages in a given session.", "scope": "", "scopeKind": ""}], "calls": ["SessionStore.get_instance()", "SessionStore.get_session()", "SessionStore.add_message()", "SessionStore.get_messages()", "SessionStore.get_message_count()", "QAService.get_instance()", "qa_service.answer"], "search-terms": ["FastAPI messaging endpoints", "session ID", "question answering service", "ChatMessage model", "send message API", "list messages API"], "state": 2, "file_id": 8, "knowledge_revision": 18, "git_revision": "", "ctags": [{"_type": "tag", "name": "ChatMessage", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^class ChatMessage(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ListMessagesResponse", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^class ListMessagesResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SendMessageRequest", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^class SendMessageRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SendMessageResponse", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^class SendMessageResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "assistant_message", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    assistant_message: ChatMessage = Field(..., description=\"Assistant reply\")$/", "language": "Python", "typeref": "typename:ChatMessage", "kind": "variable", "scope": "SendMessageResponse", "scopeKind": "class"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    content: str = Field(..., description=\"Message content\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ChatMessage", "scopeKind": "class"}, {"_type": "tag", "name": "list_messages", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^def list_messages($/", "language": "Python", "kind": "function", "signature": "( session_id: str = Query(..., description=\"Session ID to fetch messages for\"), )"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    message: str = Field(..., min_length=1, description=\"User message content\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SendMessageRequest", "scopeKind": "class"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    messages: List[ChatMessage] = Field(..., description=\"Chronological messages\")$/", "language": "Python", "typeref": "typename:List[ChatMessage]", "kind": "variable", "scope": "ListMessagesResponse", "scopeKind": "class"}, {"_type": "tag", "name": "qa_service", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^qa_service = QAService.get_instance()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    role: Literal[\"user\", \"assistant\"] = Field(..., description=\"Message author role\")$/", "language": "Python", "typeref": "typename:Literal[\"user\", \"assistant\"]", "kind": "variable", "scope": "ChatMessage", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^router = APIRouter(prefix=\"\\/messages\", tags=[\"messages\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "send_message", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^def send_message(payload: SendMessageRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: SendMessageRequest)"}, {"_type": "tag", "name": "session_id", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    session_id: str = Field(..., description=\"Target session ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "ListMessagesResponse", "scopeKind": "class"}, {"_type": "tag", "name": "session_id", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    session_id: str = Field(..., description=\"Target session ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SendMessageRequest", "scopeKind": "class"}, {"_type": "tag", "name": "session_id", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    session_id: str = Field(..., description=\"Target session ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SendMessageResponse", "scopeKind": "class"}, {"_type": "tag", "name": "store", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^store = SessionStore.get_instance()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "timestamp", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    timestamp: datetime = Field(..., description=\"UTC timestamp\")$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "ChatMessage", "scopeKind": "class"}, {"_type": "tag", "name": "total_messages", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    total_messages: int = Field(..., description=\"Total messages after send\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "SendMessageResponse", "scopeKind": "class"}, {"_type": "tag", "name": "user_message", "path": "/home/kavia/workspace/code-generation/conversational-qa-chatbot-2995-3005/q_a_backend/src/api/routers/messages.py", "pattern": "/^    user_message: ChatMessage = Field(..., description=\"Echo of the user's message\")$/", "language": "Python", "typeref": "typename:ChatMessage", "kind": "variable", "scope": "SendMessageResponse", "scopeKind": "class"}], "hash": "fb1292ed7e4996204f7e0d59a9b1d200", "format-version": 4, "code-base-name": "q_a_backend", "filename": "q_a_backend/src/api/routers/messages.py", "fields": [{"name": "ChatMessage assistant_message", "scope": "SendMessageResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str content", "scope": "ChatMessage", "scopeKind": "class", "description": "unavailable"}, {"name": "str message", "scope": "SendMessageRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "List[ChatMessage] messages", "scope": "ListMessagesResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "qa_service = QAService.get_instance()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Literal[\"user\", \"assistant\"] role", "scope": "ChatMessage", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/messages\", tags=[\"messages\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str session_id", "scope": "ListMessagesResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "store = SessionStore.get_instance()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "datetime timestamp", "scope": "ChatMessage", "scopeKind": "class", "description": "unavailable"}, {"name": "int total_messages", "scope": "SendMessageResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "ChatMessage user_message", "scope": "SendMessageResponse", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"18": ""}]}